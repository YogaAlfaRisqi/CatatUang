model Goal {
  id                String               @id @default(cuid())
  userId            String
  title             String
  description       String?
  icon              String?
  color             String?
  targetAmount      Decimal              @db.Decimal(15, 2)
  currentAmount     Decimal              @default(0) @db.Decimal(15, 2)
  currency          Currency             @default(IDR)
  startDate         DateTime             @default(now())
  deadline          DateTime?
  status            GoalStatus           @default(ACTIVE)
  milestones        Json?
  autoSaveEnabled   Boolean              @default(false)
  autoSaveAmount    Decimal?             @db.Decimal(15, 2)
  autoSaveFrequency RecurrenceFrequency?
  completedAt       DateTime?
  createdAt         DateTime             @default(now())
  updatedAt         DateTime             @updatedAt
  deletedAt         DateTime?
  contributions     GoalContribution[]
  user              User                 @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@index([deadline])
  @@map("goals")
  @@schema("goal")
}

model GoalContribution {
  id            String   @id @default(cuid())
  goalId        String
  amount        Decimal  @db.Decimal(15, 2)
  notes         String?
  contributedAt DateTime @default(now())
  goal          Goal     @relation(fields: [goalId], references: [id], onDelete: Cascade)

  @@index([goalId])
  @@index([contributedAt])
  @@map("goal_contributions")
  @@schema("goal")
}
